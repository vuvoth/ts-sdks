# Copyright (c) Mysten Labs, Inc.
# SPDX-License-Identifier: Apache-2.0

query getOwnedObjects(
	$owner: SuiAddress!
	$limit: Int
	$cursor: String
	$filter: ObjectFilter
	$includeContent: Boolean = false
	$includePreviousTransaction: Boolean = false
	$includeObjectBcs: Boolean = false
	$includeJson: Boolean = false
) {
	address(address: $owner) {
		objects(first: $limit, after: $cursor, filter: $filter) {
			pageInfo {
				hasNextPage
				endCursor
			}
			nodes {
				...MOVE_OBJECT_FIELDS
			}
		}
	}
}

query multiGetObjects(
	$objectKeys: [ObjectKey!]!
	$includeContent: Boolean = false
	$includePreviousTransaction: Boolean = false
	$includeObjectBcs: Boolean = false
	$includeJson: Boolean = false
) {
	multiGetObjects(keys: $objectKeys) {
		...OBJECT_FIELDS
	}
}

fragment OBJECT_FIELDS on Object {
	address
	digest
	version
	objectBcs @include(if: $includeObjectBcs)
	asMoveObject {
		contents {
			bcs @include(if: $includeContent)
			json @include(if: $includeJson)
			type {
				repr
			}
		}
	}
	asMovePackage {
		__typename
	}
	owner {
		...OBJECT_OWNER_FIELDS
	}
	previousTransaction @include(if: $includePreviousTransaction) {
		digest
	}
}

fragment MOVE_OBJECT_FIELDS on MoveObject {
	address
	digest
	version
	objectBcs @include(if: $includeObjectBcs)
	contents {
		bcs @include(if: $includeContent)
		json @include(if: $includeJson)
		type {
			repr
		}
	}
	owner {
		...OBJECT_OWNER_FIELDS
	}
	previousTransaction @include(if: $includePreviousTransaction) {
		digest
	}
}

fragment OBJECT_OWNER_FIELDS on Owner {
	__typename
	... on AddressOwner {
		address {
			address
		}
	}
	... on ObjectOwner {
		address {
			address
		}
	}
	... on Shared {
		initialSharedVersion
	}
	... on ConsensusAddressOwner {
		startVersion
		address {
			address
		}
	}
}
