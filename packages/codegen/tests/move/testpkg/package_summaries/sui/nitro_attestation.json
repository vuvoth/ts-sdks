{
  "id": {
    "address": "sui",
    "name": "nitro_attestation"
  },
  "doc": null,
  "immediate_dependencies": [
    {
      "address": "std",
      "name": "option"
    },
    {
      "address": "sui",
      "name": "clock"
    }
  ],
  "attributes": [],
  "functions": {
    "load_nitro_attestation": {
      "source_index": 0,
      "index": 0,
      "doc": " @param attestation: attesttaion documents bytes data.\n @param clock: the clock object.\n\n Returns the parsed NitroAttestationDocument after verifying the attestation,\n may abort with errors described above.",
      "attributes": [],
      "visibility": "Private",
      "entry": true,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "vector": "u8"
          }
        },
        {
          "name": "clock",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "clock"
                  },
                  "name": "Clock",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Datatype": {
            "module": {
              "address": "sui",
              "name": "nitro_attestation"
            },
            "name": "NitroAttestationDocument",
            "type_arguments": []
          }
        }
      ]
    },
    "module_id": {
      "source_index": 1,
      "index": 1,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "vector": "u8"
            }
          ]
        }
      ]
    },
    "timestamp": {
      "source_index": 2,
      "index": 2,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            "u64"
          ]
        }
      ]
    },
    "digest": {
      "source_index": 3,
      "index": 3,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "vector": "u8"
            }
          ]
        }
      ]
    },
    "pcrs": {
      "source_index": 4,
      "index": 4,
      "doc": " Returns a list of mapping PCREntry containg the index and the PCR bytes.\n AWS supports PCR0-31. Required PCRs (index 0-4 & 8) are always included regardless of their \n value. In devnet and testnet, additional custom PCRs (index 5-7, 9-31) are also included if \n they are nonzeros. In mainnet, only required PCRs (index 0-4 & 8) are included.",
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "vector": {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "PCREntry",
                  "type_arguments": []
                }
              }
            }
          ]
        }
      ]
    },
    "public_key": {
      "source_index": 5,
      "index": 5,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "Datatype": {
                "module": {
                  "address": "std",
                  "name": "option"
                },
                "name": "Option",
                "type_arguments": [
                  {
                    "phantom": false,
                    "argument": {
                      "vector": "u8"
                    }
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    "user_data": {
      "source_index": 6,
      "index": 6,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "Datatype": {
                "module": {
                  "address": "std",
                  "name": "option"
                },
                "name": "Option",
                "type_arguments": [
                  {
                    "phantom": false,
                    "argument": {
                      "vector": "u8"
                    }
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    "nonce": {
      "source_index": 7,
      "index": 7,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "NitroAttestationDocument",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "Datatype": {
                "module": {
                  "address": "std",
                  "name": "option"
                },
                "name": "Option",
                "type_arguments": [
                  {
                    "phantom": false,
                    "argument": {
                      "vector": "u8"
                    }
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    "index": {
      "source_index": 8,
      "index": 8,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "entry",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "PCREntry",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        "u8"
      ]
    },
    "value": {
      "source_index": 9,
      "index": 9,
      "doc": null,
      "attributes": [],
      "visibility": "Public",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "entry",
          "type_": {
            "Reference": [
              false,
              {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "PCREntry",
                  "type_arguments": []
                }
              }
            ]
          }
        }
      ],
      "return_": [
        {
          "Reference": [
            false,
            {
              "vector": "u8"
            }
          ]
        }
      ]
    },
    "load_nitro_attestation_internal": {
      "source_index": 10,
      "index": 10,
      "doc": " Internal native function",
      "attributes": [],
      "visibility": "Private",
      "entry": false,
      "type_parameters": [],
      "parameters": [
        {
          "name": "attestation",
          "type_": {
            "Reference": [
              false,
              {
                "vector": "u8"
              }
            ]
          }
        },
        {
          "name": "current_timestamp",
          "type_": "u64"
        }
      ],
      "return_": [
        {
          "Datatype": {
            "module": {
              "address": "sui",
              "name": "nitro_attestation"
            },
            "name": "NitroAttestationDocument",
            "type_arguments": []
          }
        }
      ]
    }
  },
  "structs": {
    "PCREntry": {
      "index": 0,
      "doc": " Represents a PCR entry with an index and value.",
      "attributes": [],
      "abilities": [
        "Drop"
      ],
      "type_parameters": [],
      "fields": {
        "positional_fields": false,
        "fields": {
          "index": {
            "index": 0,
            "doc": null,
            "type_": "u8"
          },
          "value": {
            "index": 1,
            "doc": null,
            "type_": {
              "vector": "u8"
            }
          }
        }
      }
    },
    "NitroAttestationDocument": {
      "index": 1,
      "doc": " Nitro Attestation Document defined for AWS.",
      "attributes": [],
      "abilities": [
        "Drop"
      ],
      "type_parameters": [],
      "fields": {
        "positional_fields": false,
        "fields": {
          "module_id": {
            "index": 0,
            "doc": " Issuing Nitro hypervisor module ID.",
            "type_": {
              "vector": "u8"
            }
          },
          "timestamp": {
            "index": 1,
            "doc": " UTC time when document was created, in milliseconds since UNIX epoch.",
            "type_": "u64"
          },
          "digest": {
            "index": 2,
            "doc": " The digest function used for calculating the register values.",
            "type_": {
              "vector": "u8"
            }
          },
          "pcrs": {
            "index": 3,
            "doc": " A list of PCREntry containing the index and the PCR bytes.\n <https://docs.aws.amazon.com/enclaves/latest/user/set-up-attestation.html#where>.",
            "type_": {
              "vector": {
                "Datatype": {
                  "module": {
                    "address": "sui",
                    "name": "nitro_attestation"
                  },
                  "name": "PCREntry",
                  "type_arguments": []
                }
              }
            }
          },
          "public_key": {
            "index": 4,
            "doc": " An optional DER-encoded key the attestation, consumer can use to encrypt data with.",
            "type_": {
              "Datatype": {
                "module": {
                  "address": "std",
                  "name": "option"
                },
                "name": "Option",
                "type_arguments": [
                  {
                    "phantom": false,
                    "argument": {
                      "vector": "u8"
                    }
                  }
                ]
              }
            }
          },
          "user_data": {
            "index": 5,
            "doc": " Additional signed user data, defined by protocol.",
            "type_": {
              "Datatype": {
                "module": {
                  "address": "std",
                  "name": "option"
                },
                "name": "Option",
                "type_arguments": [
                  {
                    "phantom": false,
                    "argument": {
                      "vector": "u8"
                    }
                  }
                ]
              }
            }
          },
          "nonce": {
            "index": 6,
            "doc": " An optional cryptographic nonce provided by the attestation consumer as a proof of\n authenticity.",
            "type_": {
              "Datatype": {
                "module": {
                  "address": "std",
                  "name": "option"
                },
                "name": "Option",
                "type_arguments": [
                  {
                    "phantom": false,
                    "argument": {
                      "vector": "u8"
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  "enums": {}
}